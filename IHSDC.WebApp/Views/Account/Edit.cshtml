@using Microsoft.AspNet.Identity
@using IHSDC.WebApp.Helper
@using IHSDC.WebApp.Connection

@model IHSDC.WebApp.Models.EditUserViewModel


@{
    var message = TempData["Message"] ?? string.Empty;
    var messageStatus = TempData["messageStatus"] ?? string.Empty;
    var messagemidStatus = TempData["messagemidStatus"] ?? string.Empty;
    ViewBag.Title = "Edit User";
    Layout = "~/Views/Shared/_NewAA7Layout.cshtml"; }

@*<h2>@ViewBag.Title.</h2>*@
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @*<h4 style="color: #044C92; font-size: 2rem;">Update details for @ViewBag.EditUsername.</h4>*@
    @*<hr />*@
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="form-group">
        <div class="col-md-12">
            @Html.HiddenFor(model => model.UserId, new { htmlAttributes = new { @class = "form-control disabled" } })
        </div>
    </div>
    <div class="card-body" style="width:50%; box-shadow: -1px 1px 8px 1px; margin-top:5px; margin-left:450px;">
        <div class="card-body">
            <div class="card-body" style="padding: 0.3rem; border: 0px solid #89CFF0;">
                <div class="row">
                    <div class="col-md-4"></div>
                    <div class="col-md-4 headingtext">UPDATE : @ViewBag.EditUsername</div>
                    <div class="col-md-4"></div>
                    <span id="spnUserTypeId" style="display:none">@ViewData["UserTypeId"]</span>
                    <span id="UnitId" style="display:none">@ViewData["UnitId"]</span>
                </div>
                <hr />
                @if (SessionManager.RoleId == enum1.Administrator)
                {

                    <div class="container">

                        <div class="form-row row-cols-3">
                            <!-- First Row -->
                            <div class="form-group required" style="width:300px;">
                                @Html.LabelFor(m => m.Username, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Username, new { @class = "form-control", @onkeyup = "ValInData(this)" })
                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Roles, new { @class = "col-md-12 control-label Roles" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.Roles, (IEnumerable<SelectListItem>)ViewData["Roles"], new { style = "width:270px;height:35px;background-color:#f2f2f2", @class = "Roles" })
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(model => model.Active, htmlAttributes: new { @class = "control-label col-md-12" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(model => model.Active, (new IHSDC.WebApp.Models.MasterModels()).LoadActive(), "--Select --", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })
                                </div>
                            </div>
                        </div>

                        <!--<div class="form-group" style="width:300px;">
                        @Html.LabelFor(m => m.DEFwdAuth, new { @class = "col-md-12 control-label" })
                        <div class="col-md-12">-->
                        @*@Html.TextBoxFor(m => m.DEFwdAuth, new { @class = "form-control" })*@
                        <!--@Html.DropDownListFor(m => m.DEFwdAuth, (new IHSDC.WebApp.Models.MasterModels()).LoadUserList(""), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true"})

                            </div>
                        </div>
                        <div class="form-group" style="width:300px;">
                            @Html.LabelFor(m => m.GEBFwdAuth, new { @class = "col-md-12 control-label" })
                            <div class="col-md-12">
                                @Html.DropDownListFor(m => m.GEBFwdAuth, (new IHSDC.WebApp.Models.MasterModels()).LoadUserList(""), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true"})
                            </div>
                        </div>-->

                        <div class="form-row row-cols-3">
                            <!-- Second Row -->
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Number, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Number, new { @class = "form-control", @onkeyup = "ValInData(this)" })
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Rank, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.Rank, (new IHSDC.WebApp.Models.MasterModels()).LoadRanks(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })

                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.FullName, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", @onkeyup = "ValInData(this)" })
                                </div>
                            </div>

                            <div class="form-group d-none" style="width: 300px;">
                                @Html.LabelFor(m => m.Password, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.PasswordFor(m => m.Password, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>

                        <div class="form-row row-cols-3">
                            <!-- Third Row -->
                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:9px;margin-left:12px">Comd/PSOs</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddComd", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.ComdId, (new IHSDC.WebApp.Models.MasterModels()).LoadCommandName(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })
                                </div>

                            </div>

                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:8px;margin-left:12px">DGs</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddCorps", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.CorpId, new { @class = "form-control d-none", @required = true })
                                    <select id="spnCorp" class="form-control"></select>
                                </div>
                            </div>

                            <div class="form-group d-none" style="width: 300px;">
                                <label style="margin-top:8px;margin-left:12px">Bde</label>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.BdeId, new { @class = "form-control d-none", @required = true })
                                    <select id="spnBde" class="form-control"></select>
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:9px;margin-left:12px">Branch</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddUnit", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Unit_ID, new { @class = "form-control d-none", @required = true })
                                    <select id="spnUnit" class="form-control" required></select>
                                </div>
                            </div>
                        </div>

                        <div class="form-row row-cols-3">

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Appointment, new { @class = "col-md-12 control-label" })
                                <a href='@Url.Action("AddAppt", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @*@Html.TextBoxFor(m => m.Appointment, new { @class = "form-control" })*@
                                    @Html.DropDownListFor(m => m.Appointment, (new IHSDC.WebApp.Models.MasterModels()).LoadAppointment(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })

                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.ASCON, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.ASCON, new { @class = "form-control", @onkeyup = "ValInData1(this)" })
                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.MobNo, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.MobNo, new { @class = "form-control", @oninput = "ValInData1(this)", @maxlength = "10", @required = true })

                                </div>
                            </div>
                        </div>
                    </div>

                }

                @if (SessionManager.RoleId == enum1.GSO1 || SessionManager.RoleId == enum1.Sponsor || SessionManager.RoleId == enum1.Nodal)
                {

                    <div class="container">

                        <div class="form-row row-cols-3">
                            <!-- First Row -->
                            <div class="form-group required" style="width:300px;">
                                @Html.LabelFor(m => m.Username, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Username, new { @class = "form-control", @onkeyup = "ValInData(this)", @readonly = "readonly" })
                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Roles, new { @class = "col-md-12 control-label Roles" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.Roles, (IEnumerable<SelectListItem>)ViewData["Roles"], new { style = "width:270px;height:35px;background-color:#f2f2f2;pointer-events: none;", @class = "Roles" })
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(model => model.Active, htmlAttributes: new { @class = "control-label col-md-12" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(model => model.Active, (new IHSDC.WebApp.Models.MasterModels()).LoadActive(), "--Select --", new { style = "pointer-events: none;", @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })
                                </div>
                            </div>
                        </div>

                        <!--<div class="form-group" style="width:300px;">
                        @Html.LabelFor(m => m.DEFwdAuth, new { @class = "col-md-12 control-label" })
                        <div class="col-md-12">-->
                        @*@Html.TextBoxFor(m => m.DEFwdAuth, new { @class = "form-control" })*@
                        <!--@Html.DropDownListFor(m => m.DEFwdAuth, (new IHSDC.WebApp.Models.MasterModels()).LoadUserList(""), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true"})

                            </div>
                        </div>
                        <div class="form-group" style="width:300px;">
                            @Html.LabelFor(m => m.GEBFwdAuth, new { @class = "col-md-12 control-label" })
                            <div class="col-md-12">
                                @Html.DropDownListFor(m => m.GEBFwdAuth, (new IHSDC.WebApp.Models.MasterModels()).LoadUserList(""), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true"})
                            </div>
                        </div>-->

                        <div class="form-row row-cols-3">
                            <!-- Second Row -->
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Number, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Number, new { @class = "form-control", @onkeyup = "ValInData(this)" })
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.Rank, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.Rank, (new IHSDC.WebApp.Models.MasterModels()).LoadRanks(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })

                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.FullName, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", @onkeyup = "ValInData(this)" })
                                </div>
                            </div>

                            <div class="form-group d-none" style="width: 300px;">
                                @Html.LabelFor(m => m.Password, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.PasswordFor(m => m.Password, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>

                        <div class="form-row row-cols-3">
                            <!-- Third Row -->
                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:9px;margin-left:12px">Comd/PSOs</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>

                                <div class="col-md-12">
                                    @Html.DropDownListFor(m => m.ComdId, (new IHSDC.WebApp.Models.MasterModels()).LoadCommandName(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })
                                </div>

                            </div>

                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:8px;margin-left:12px">DGs</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddCorps", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.CorpId, new { @class = "form-control d-none", @required = true })
                                    <select id="spnCorp" class="form-control"></select>
                                </div>
                            </div>

                            <div class="form-group d-none" style="width: 300px;">
                                <label style="margin-top:8px;margin-left:12px">Bde</label>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.BdeId, new { @class = "form-control d-none", @required = true })
                                    <select id="spnBde" class="form-control"></select>
                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:9px;margin-left:12px">Branch</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddUnit", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.Unit_ID, new { @class = "form-control d-none", @required = true })
                                    <select id="spnUnit" class="form-control" required></select>
                                </div>
                            </div>
                        </div>

                        <div class="form-row row-cols-3">

                            <div class="form-group required" style="width: 300px;">
                                <label style="margin-top:8px;margin-left:12px">Appt</label><font style="color:red; font-weight:bold; font-size:20px;">*</font>
                                <a href='@Url.Action("AddAppt", "Master")' )>
                                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                </a>
                                <div class="col-md-12">
                                    @*@Html.TextBoxFor(m => m.Appointment, new { @class = "form-control" })*@
                                    @Html.DropDownListFor(m => m.Appointment, (new IHSDC.WebApp.Models.MasterModels()).LoadAppointment(), "--Select--", new { @data_show_subtext = "true", @class = "select form-control", @data_live_search = "true", @required = true })

                                </div>
                            </div>

                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.ASCON, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.ASCON, new { @class = "form-control", @onkeyup = "ValInData1(this)" })
                                </div>
                            </div>
                            <div class="form-group required" style="width: 300px;">
                                @Html.LabelFor(m => m.MobNo, new { @class = "col-md-12 control-label" })
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.MobNo, new { @class = "form-control", @oninput = "ValInData1(this)", @maxlength = "10", @required = true })

                                </div>
                            </div>
                        </div>
                    </div>

                }


                <hr />
                <div class="row">
                    <div class="col-12 d-flex justify-content-center">
                        <div class="form-group">
                            <div class="col-md-offset-2 text-center">
                                <input type="submit" value="Save" class="btn btn-primary" />
                                @if (SessionManager.RoleId == enum1.Administrator)
                                {
                                    <span>
                                        <a class="btn btn-primary" href="/Account/Hierarchy" style=" margin-left: 1rem;">Back to List</a>
                                    </span>
                                }
                                @*<span class="btn btn-info text-light" style="color:white;">@Html.ActionLink("Back to List", "Hierarchy")</span>*@
                            </div>
                        </div>
                    </div>
                </div>






            </div>
        </div>
    </div>


}

<script src="~/Scripts/jquery-3.3.1.js"></script>
<script src="~/Content/CustomJS/SignUp.js"></script>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
<script>
    $(document).ready(function () {



        /*BindComdbyUnit($('#Unit_ID').val());*/
        $('#spnUnit_ID').change(function () {

            $("#Unit_ID").val($('#spnUnit_ID').val());
        });

        $('#UserTypeId').change(function () {

            /*bindunit($("#UserTypeId").val());*/
        });
        var unit_id = '@ViewBag.sel_unit_id';
        var roles_id = '@ViewBag.sel_roles_id';
        var user_id = '@ViewBag.UserId';
        var pass = '@ViewBag.pass';
        $("#Unit_ID").val(unit_id);

        $(".Roles").val(roles_id);
        $("#Password").val(pass);
        $("#UserId").val(user_id);

        $('#ComdId').val(@ViewBag.ComdId);
        $('#CorpId').val(@ViewBag.CorpId);
        BindCorp($("#ComdId").val());
        BindBde($("#ComdId").val(), $("#CorpId").val());
        BindUnit($("#ComdId").val(), $("#CorpId").val(), $("#BdeId").val());



    });
    //function bindunit(UserTypeId)
    //{
    //    var list = '';


    //    $.ajax({
    //        url: '/Master/GetUnitByhierarchy',
    //        type: 'POST',
    //        data: { "Unit_ID": UserTypeId}, //get the search string
    //        success: function (result) {


    //            if (result.length > 0) {

    //                list = '';

    //                list = '<option value="">Select Unit</option>';


    //                for (var j = 0; j < result.length; j++) {


    //                    list += '<option value=' + result[j].Value + '>' + result[j].Text + '</option>';
    //                }


    //                $('#spnUnit_ID').html(list);
    //            }
    //            // $('#SqnId').html(list);
    //            //alert($('#UnitId').html());
    //            $('#spnUnit_ID').val($('#UnitId').html());
    //        }
    //    });




    //}


    $('#ComdId').change(function () {
        $('#CorpId').val(1);
        $('#BdeId').val(1);

        BindCorp($("#ComdId").val());
        BindBde($("#ComdId").val(), $("#CorpId").val());
        BindUnit($("#ComdId").val(), $("#CorpId").val(), $("#BdeId").val());
    });


    $('#spnCorp').change(function () {
        $("#CorpId").val($('#spnCorp').val());
        BindBde($("#ComdId").val(), $("#CorpId").val());
        BindUnit($("#ComdId").val(), $("#CorpId").val(), $("#BdeId").val());
    });

    $('#spnBde').change(function () {
        $("#BdeId").val($('#spnBde').val());
        BindUnit($("#ComdId").val(), $("#CorpId").val(), $("#BdeId").val());
    });

    $('#spnUnit').change(function () {
        $("#Unit_ID").val($('#spnUnit').val());
    });
    var dropdown = document.getElementById("rolesDropdown");
    dropdown.addEventListener("keydown", function (event) {
        event.preventDefault();
    });

             var message = '@message';
    var messageStatus = '@messageStatus';
    var messagemidStatus = '@messagemidStatus';
    if (message)
            sweetAlert(message, messagemidStatus, messageStatus);
</script>

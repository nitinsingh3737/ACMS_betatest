@model IHSDC.WebApp.Models.HistoryHeptrRPADetails
@{
    ViewBag.Title = "View Aviator Details";
    Layout = "~/Views/Shared/_NewAA7LayoutMenu.cshtml"; int sno = 0;
}


<div class="row" style="float:right;">
    <a class="btn btn-info float-right" href="javascript:history.back()" target="_top">Back</a>
</div>

<div class="row">
    <img src="~/Images/PDF.png" alt="Flowers in Chania" width="40" height="45" id="btnExport" value="Export Pdf">
    @*<input type="button" class="btn btn-info float-left" id="btnExport" value="Export Pdf" />*@

</div>

<body>
    <div class="card-body" id="printDetails">
        <center><h4><b><u>HEPTR RPAS HISTORY</u></b></h4></center>

        <tbody id="tbody">
            <tr>
                <th colspan="5">
                    <h5> Aviator :    @ViewBag.AviatorName    </h5>
                </th>
                <td>
                    <h5>Unit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;@ViewBag.UnitName</h5>
                </td>

            </tr>

        </tbody>
        <div class="table-responsive" style="width:100%">
            <table class="table table-striped" id="dataTable" width="100%" cellspacing="0">
                <thead class="bg-info text-white">
                    <tr>
                        <th class="center">S/No</th>
                        <th class="center">Aircraft Type</th>
                        <th class="center">Aircraft</th>
                        <th class="center">CAT Card No</th>
                        <th class="center">CAT Card Date</th>
                        <th class="center">CAT/IR</th>
                        <th class="center">CAT/IR Date</th>
                        <th class="center">Instr CAT</th>
                        <th class="center">Instr CAT Date</th>
                        <th class="center">RPAS DOW</th>
                        <th class="center">RPAS Substream</th>
                        <th class="center">RPAS CAT Card No</th>
                        <th class="center">RPAS CAT Card Date</th>
                        <th class="center">RPAS CAT/IR</th>
                        <th class="center">RPAS CAT Date</th>
                        <th class="center">RPAS Instr CAT</th>
                        <th class="center">RPAS Instr CAT Date</th>
                        <th class="center">Status</th>
                        <th class="center">Updated</th>
                    </tr>
                </thead>
                <tbody id="tbody">
                    @if (ViewBag.ILAviatorHeptrRPAViewCRUDCount > 0)
                    {
                        foreach (var item in Model.ILAviatorHeptrRPAViewCRUD)
                        {
                            <tr>
                                <td>
                                    @{ sno++; }
                                    @sno
                                </td>
                                <td>@Html.DisplayFor(modelItem => item.AircraftType)</td>
                                <td>@Html.DisplayFor(modelItem => item.AircraftName)</td>
                                <td>@Html.DisplayFor(modelItem => item.CatCardNo)</td>
                                <td>@Html.DisplayFor(modelItem => item.CatCardDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.CatIR)</td>
                                <td>@Html.DisplayFor(modelItem => item.CatIRDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.InstrCat)</td>
                                <td>@Html.DisplayFor(modelItem => item.InstrCatDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPAdowDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPASubstream)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPA_CatCardNo)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPA_CatCardDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPACat)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPA_CatDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPA_Instr_Cat)</td>
                                <td>@Html.DisplayFor(modelItem => item.RPA_Instr_CatDate)</td>
                                <td>@Html.DisplayFor(modelItem => item.StatusAircraft)</td>
                                <td>@Html.DisplayFor(modelItem => item.DateTimeOfUpdate)</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr><td colspan="12" style="font-weight:900;color:red;text-align:center"> No Record Found!!!</td></tr>
                    }
                </tbody>
            </table>
        </div>


        <form action="~/Home/Upload" method="post" id="myForm">
            <input type="hidden" name="data1" id="data1">
            <input type="hidden" name="filename" id="filename" value="AviatorDetails">
        </form>
    </div>
</body>

<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script src="~/Scripts/pdfmake.min.js"></script>
<script src="~/Scripts/html2canvas.min.js"></script>
<script>
    $("body").on("click", "#btnExport", function () {
        //debugger;
            html2canvas($('#printDetails')[0], {
                onrendered: function (canvas) {
                    var data = canvas.toDataURL();
                    var docDefinition = {
                        content: [{
                            image: data,
                            width: 500
                        }]
                    };                   
                    // pdfMake.createPdf(docDefinition).download("Aviator.pdf");
                    const pdfDocGenerator = pdfMake.createPdf(docDefinition);
                    pdfDocGenerator.getBase64((data) => {
                        $('#data1').val(data);
                        $("#myForm").submit();
                    });
                }
            });
        });

   
</script>



